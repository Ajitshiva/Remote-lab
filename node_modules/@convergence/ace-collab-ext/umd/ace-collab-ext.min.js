/**!
Â© 2016-2019 Convergence Labs, Inc.
@version 0.4.0
@license MIT
*/
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("ace")):"function"==typeof define&&define.amd?define("AceCollabExt",["ace"],t):"object"==typeof exports?exports.AceCollabExt=t(require("ace")):e.AceCollabExt=t(e.ace)}(window,function(e){return function(e){var t={};function s(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,s),o.l=!0,o.exports}return s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(i,o,function(t){return e[t]}.bind(null,o));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";function i(e){for(var s in e)t.hasOwnProperty(s)||(t[s]=e[s])}Object.defineProperty(t,"__esModule",{value:!0}),i(s(1)),i(s(3)),i(s(5)),i(s(7)),i(s(9))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(2);t.AceMultiSelectionManager=class{constructor(e){this._selections={},this._session=e}addSelection(e,t,s,o){if(void 0!==this._selections[e])throw new Error("Selection with id already defined: "+e);const r=new i.AceSelectionMarker(this._session,e,t,s,o);this._selections[e]=r,this._session.addDynamicMarker(r,!1)}setSelection(e,t){this._getSelection(e).setSelection(t)}clearSelection(e){this._getSelection(e).setSelection(null)}removeSelection(e){const t=this._selections[e];if(void 0===t)throw new Error("Selection not found: "+e);this._session.removeMarker(t.id),delete this._selections[e]}removeAll(){Object.getOwnPropertyNames(this._selections).forEach(e=>{this.removeSelection(this._selections[e].selectionId())})}_getSelection(e){const t=this._selections[e];if(void 0===t)throw new Error("Selection not found: "+e);return t}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AceSelectionMarker=class{constructor(e,t,s,i,o){this._session=e,this._label=s,this._color=i,this._ranges=o||[],this._selectionId=t,this._id=null,this._markerElement=document.createElement("div")}update(e,t,s,i){for(;this._markerElement.hasChildNodes();)this._markerElement.removeChild(this._markerElement.lastChild);this._ranges.forEach(e=>{this._renderRange(t,s,i,e)}),this._markerElement.remove(),t.elt("remote-selection",""),(t.element.childNodes[t.i-1]||t.element.lastChild).appendChild(this._markerElement)}setSelection(e){null==e?this._ranges=[]:e instanceof Array?this._ranges=e:this._ranges=[e],this._forceSessionUpdate()}getLabel(){return this._label}selectionId(){return this._selectionId}markerId(){return this._id}_renderLine(e){const t=document.createElement("div");t.className="ace-multi-selection",t.style.backgroundColor=this._color,"number"==typeof e.height&&(t.style.height=`${e.height}px`),"number"==typeof e.width&&(t.style.width=`${e.width}px`),"number"==typeof e.top&&(t.style.top=`${e.top}px`),"number"==typeof e.left&&(t.style.left=`${e.left}px`),"number"==typeof e.bottom&&(t.style.bottom=`${e.bottom}px`),"number"==typeof e.right&&(t.style.right=`${e.right}px`),this._markerElement.append(t)}_renderRange(e,t,s,i){const o=i.toScreenRange(t);let r=s.lineHeight,n=e.$getTop(o.start.row,s),l=0;const c=e.$padding+o.start.column*s.characterWidth;if(o.isMultiLine()){if(this._renderLine({height:r,right:0,top:n,left:c}),n=e.$getTop(o.end.row,s),l=o.end.column*s.characterWidth,this._renderLine({height:r,width:l,top:n,left:e.$padding}),(r=(o.end.row-o.start.row-1)*s.lineHeight)<0)return;n=e.$getTop(o.start.row+1,s),this._renderLine({height:r,right:0,top:n,left:e.$padding})}else l=(i.end.column-i.start.column)*s.characterWidth,this._renderLine({height:r,width:l,top:n,left:c})}_forceSessionUpdate(){this._session._signal("changeBackMarker")}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(4);t.AceMultiCursorManager=class{constructor(e){this._cursors={},this._session=e}addCursor(e,t,s,o){if(void 0!==this._cursors[e])throw new Error(`Cursor with id already defined: ${e}`);const r=new i.AceCursorMarker(this._session,e,t,s,o);this._cursors[e]=r,this._session.addDynamicMarker(r,!0)}setCursor(e,t){this._getCursor(e).setPosition(t)}clearCursor(e){this._getCursor(e).setPosition(null)}removeCursor(e){const t=this._cursors[e];if(void 0===t)throw new Error(`Cursor not found: ${e}`);this._session.removeMarker(t.id),delete this._cursors[e]}removeAll(){Object.getOwnPropertyNames(this._cursors).forEach(e=>{this.removeCursor(this._cursors[e].cursorId())})}_getCursor(e){const t=this._cursors[e];if(void 0===t)throw new Error(`Cursor not found: ${e}`);return t}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AceCursorMarker=class{constructor(e,t,s,i,o){this._session=e,this._label=s,this._color=i,this._position=o?this._convertPosition(o):null,this._cursorId=t,this._id=null,this._visible=!1,this._tooltipTimeout=null,this._markerElement=document.createElement("div"),this._cursorElement=document.createElement("div"),this._cursorElement.className="ace-multi-cursor",this._cursorElement.style.background=this._color,this._markerElement.append(this._cursorElement),this._tooltipElement=document.createElement("div"),this._tooltipElement.className="ace-multi-cursor-tooltip",this._tooltipElement.style.background=this._color,this._tooltipElement.style.opacity="0",this._tooltipElement.innerHTML=s,this._markerElement.append(this._tooltipElement)}update(e,t,s,i){if(null===this._position)return;const o=this._session.documentToScreenPosition(this._position.row,this._position.column),r=t.$getTop(o.row,i),n=t.$padding+o.column*i.characterWidth,l=i.lineHeight,c=r+2,a=l-3,h=n;this._cursorElement.style.height=`${a}px`,this._cursorElement.style.width="2px",this._cursorElement.style.top=`${c}px`,this._cursorElement.style.left=`${h}px`;let u=c-l;u<5&&(u=c+l-1);const d=h;this._tooltipElement.style.top=`${u-2}px`,this._tooltipElement.style.left=`${d-2}px`,this._markerElement.remove(),t.elt("remote-cursor",""),(t.element.childNodes[t.i-1]||t.element.lastChild).appendChild(this._markerElement)}setPosition(e){this._position=this._convertPosition(e),this._forceSessionUpdate(),this._tooltipElement.style.opacity="1",this._scheduleTooltipHide()}setVisible(e){const t=this._visible;this._visible=e,t!==this._visible&&(this._markerElement.style.visibility=e?"visible":"hidden",this._forceSessionUpdate())}isVisible(){return this._visible}cursorId(){return this._cursorId}markerId(){return this._id}getLabel(){return this._label}_forceSessionUpdate(){this._session._signal("changeFrontMarker")}_convertPosition(e){if(null===e)return null;if("number"==typeof e)return this._session.getDocument().indexToPosition(e,0);if("number"==typeof e.row&&"number"==typeof e.column)return e;throw new Error(`Invalid position: ${e}`)}_scheduleTooltipHide(){null!==this._tooltipTimeout&&clearTimeout(this._tooltipTimeout),this._tooltipTimeout=setTimeout(()=>{this._tooltipElement.style.opacity="0",this._tooltipTimeout=null},2e3)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(6);class o{static rangeToJson(e){return{start:{row:e.start.row,column:e.start.column},end:{row:e.end.row,column:e.end.column}}}static jsonToRange(e){return new i.Range(e.start.row,e.start.column,e.end.row,e.end.column)}static rangesToJson(e){return e.map(e=>o.rangeToJson(e))}static jsonToRanges(e){return e.map(e=>o.jsonToRange(e))}static toJson(e){return Array.isArray(e)?o.rangesToJson(e):o.rangeToJson(e)}static fromJson(e){return Array.isArray(e)?o.jsonToRanges(e):o.jsonToRange(e)}}t.AceRangeUtil=o},function(t,s){t.exports=e},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(8);t.AceRadarView=class{constructor(e,t){this._container=null,this._container="string"==typeof e?document.getElementById(e):e,this._container.style.position="relative",this._views={},this._editor=t}addView(e,t,s,o,r){const n=new i.AceRadarViewIndicator(t,s,o,r,this._editor);this._container.appendChild(n.element()),n.update(),this._views[e]=n}hasView(e){return void 0!==this._views[e]}setViewRows(e,t){this._views[e].setViewRows(t)}setCursorRow(e,t){this._views[e].setCursorRow(t)}clearView(e){const t=this._views[e];t.setCursorRow(null),t.setViewRows(null)}removeView(e){this._views[e].dispose(),delete this._views[e]}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function i(e){return null!=e}t.AceRadarViewIndicator=class{constructor(e,t,s,i,o){this._label=e,this._color=t,this._viewRows=s,this._cursorRow=i,this._editor=o,this._docLineCount=o.getSession().getLength(),this._editorListener=(()=>{const e=this._editor.getSession().getLength();e!==this._docLineCount&&(this._docLineCount=e,this.update())}),this._editor.on("change",this._editorListener),this._scrollElement=document.createElement("div"),this._scrollElement.className="ace-radar-view-scroll-indicator",this._scrollElement.style.borderColor=this._color,this._scrollElement.style.background=this._color,this._scrollElement.title=this._label,this._scrollElement.addEventListener("click",()=>{const e=(this._viewRows.end-this._viewRows.start)/2+this._viewRows.start;this._editor.scrollToLine(e,!0,!1,()=>{})},!1),this._cursorElement=document.createElement("div"),this._cursorElement.className="ace-radar-view-cursor-indicator",this._cursorElement.style.background=this._color,this._cursorElement.title=this._label,this._cursorElement.addEventListener("click",()=>{this._editor.scrollToLine(this._cursorRow,!0,!1,()=>{})},!1),this._wrapper=document.createElement("div"),this._wrapper.className="ace-radar-view-wrapper",this._wrapper.style.display="none",this._wrapper.appendChild(this._scrollElement),this._wrapper.appendChild(this._cursorElement)}element(){return this._wrapper}setCursorRow(e){this._cursorRow=e,this.update()}setViewRows(e){this._viewRows=e,this.update()}update(){if(i(this._viewRows)||i(this._cursorRow)){this._wrapper.style.display=null;const e=this._docLineCount-1;if(i(this._viewRows)){const t=Math.min(e,this._viewRows.start)/e*100,s=100-Math.min(e,this._viewRows.end)/e*100;this._scrollElement.style.top=t+"%",this._scrollElement.style.bottom=s+"%",this._scrollElement.style.display=null}else this._scrollElement.style.display="none";if(i(this._cursorRow)){const t=Math.min(this._cursorRow,e)/e*((this._wrapper.offsetHeight-this._cursorElement.offsetHeight)/this._wrapper.offsetHeight)*100;this._cursorElement.style.top=t+"%",this._cursorElement.style.display=null}else this._cursorElement.style.display="none"}else this._wrapper.style.display="none"}dispose(){this._wrapper.parentNode.removeChild(this._wrapper),this._editor.off("change",this._editorListener)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AceViewportUtil=class{static getVisibleIndexRange(e){let t=e.getFirstVisibleRow(),s=e.getLastVisibleRow();return e.isRowFullyVisible(t)||t++,e.isRowFullyVisible(s)||s--,{start:e.getSession().getDocument().positionToIndex({row:t,column:0},0),end:e.getSession().getDocument().positionToIndex({row:s,column:0},0)}}static indicesToRows(e,t,s){return{start:e.getSession().getDocument().indexToPosition(t,0).row,end:e.getSession().getDocument().indexToPosition(s,0).row}}}}])});
//# sourceMappingURL=ace-collab-ext.min.js.map
